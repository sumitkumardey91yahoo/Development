webpackJsonp([47],{628:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s(5),a=s(4),r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=s[i])}return e};t.default={data:function(){return{firstPinActive:!1,pin:"",confirmPin:"",pinError:void 0,pinErrorMessage:"",altUser:void 0,username:void 0,password:void 0,exitKidsScreenCode:""}},computed:r({},s.i(a.a)(["altKidsUser","passphrase","searchResults","altKidsProfile","altMessages"])),methods:r({},s.i(a.b)(["setUser","setAccount","setSearchResults","setKidsPlayerContent"]),s.i(a.c)(["actEditCurrentProfile","actCreateNewProfile","actGetProfileSwitch","actGetKidsProfileSwitch","actGetUserLogin","actGetAccountDetails","actGetDeviceList","actRegisterDevice","actGetOrders","actSearchQuery"]),{validateFirstPin:function(e){4==e.target.value.length&&(this.firstPinActive=!0)},validateConfirmPin:function(e){var t=this;if(4==e.target.value.length)if(e.target.value==this.pin){var s={pin:this.altKidsUser.pin};this.actEditCurrentProfile(s).then(function(e){e.status&&"ok"==e.status&&t.createNewProfile()},function(e){400==e.code&&t.createNewProfile()})}else this.pinErrorMessage="Incorrect PIN",this.pinError=!0,this.pin="",this.confirmPin="",this.firstPinActive=!1},createNewProfile:function(){var e=this,t=JSON.parse(localStorage.getItem("altUser")),s={parental_control:"R",password:this.generateRandomId(32),type:"regular",username:"kids"+t.email};this.actCreateNewProfile(s).then(function(t){t&&(e.altUser={email:t.email,profileId:t.id,parentalControl:t.parental_control,type:t.type,username:t.username,pin:e.pin},e.switchUserProfile())},function(e){})},switchUserProfile:function(){this.actGetProfileSwitch(this.altUser).then(function(e){},function(e){})},exitKidsEvent:function(e){var t=this;if(this.pinError=!1,this.pinErrorMessage=void 0,4==e.target.value.length){var s=e.target.value;this.actGetKidsProfileSwitch(s).then(function(e){if("ok"==e.status){var s=JSON.parse(localStorage.getItem("altUser"));s.sessionToken=e.session_token,s.uuid=e.uuid,localStorage.setItem("altProfileMode","default"),localStorage.setItem("altUser",JSON.stringify(s)),t.$router.push({name:"home"})}},function(e){"error"==e.status&&(t.pinErrorMessage=e.message,t.pinError=!0)})}},closeExitKidsPinScreen:function(){this.pinError=!1,this.pinErrorMessage=void 0,this.exitKidsScreenCode="",this.toggleExitPinScreen(!1)},getLogin:function(){var e=this;this.toggleLoader(!0),this.actGetUserLogin({username:this.username,password:this.password}).then(function(t){var s=t.account,i=t.account.profile,a={sessionToken:t.session_token?t.session_token:"",dateCreated:s.date_created?s.date_created:"",email:s.email?s.email:"",accountId:s.id?s.id:"",isAdmin:s.is_admin?s.is_admin:"",login:s.login?s.login:"",username:i.username?i.username:"",profileId:i.id?i.id:""};localStorage.setItem("token",t.session_token),localStorage.setItem("user_email",t.account.email),localStorage.setItem("account_id",t.account.id),e.altUser=a,e.getAccountLookup()},function(t){if(e.toggleAltPopup(!0,t.message),e.toggleLoader(!1),window.mobileAnalyticsClient){var s={},i=localStorage.getItem("geo_location"),a=JSON.parse(localStorage.getItem("altConfig"));i&&(i=JSON.parse(i),s=i),s.user_email=localStorage.getItem("user_email"),s.user_id=localStorage.getItem("account_id"),s.user_session=localStorage.getItem("token"),s.user_name=localStorage.getItem("user_name"),s.user_dob=localStorage.getItem("user_birthday"),s.user_gender=localStorage.getItem("user_gender"),s.app_env=a.environment.title,s.event_action="error",s.event_message=t.message,s.event_code=t.code.toString(),window.mobileAnalyticsClient.recordEvent("_user.login",s,{})}})},getAccountLookup:function(){var e=this;this.actGetAccountDetails(this.altUser).then(function(t){if(e.altAccount={dateCreated:e.formatIsoDate(t.date_created),details:t.details,emailVerified:t.email_verified,marketingConcent:t.marketing_consent,phoneNumber:t.phone_number,profile:t.profile},localStorage.setItem("user_name",t.name+" "+t.surname),localStorage.setItem("user_birthday",t.details.birthday?t.details.birthday:""),localStorage.setItem("user_gender",t.details.gender?t.details.gender:""),window.mobileAnalyticsClient){var s={},i=localStorage.getItem("geo_location"),a=JSON.parse(localStorage.getItem("altConfig"));i&&(i=JSON.parse(i),s=i),s.user_email=localStorage.getItem("user_email"),s.user_id=localStorage.getItem("account_id"),s.user_session=localStorage.getItem("token"),s.user_name=localStorage.getItem("user_name"),s.user_dob=localStorage.getItem("user_birthday"),s.user_gender=localStorage.getItem("user_gender"),s.app_env=a.environment.title,s.event_mode="email",window.mobileAnalyticsClient.recordEvent("_user.login",s,{})}e.getDevice()},function(e){})},getDevice:function(){var e=this,t=localStorage.getItem("altDeviceId");t||(t=this.generateRandomId(32)),this.actGetDeviceList(this.altUser).then(function(s){if(s.count){var i=s.devices,a=i.filter(function(e){return e.uuid==t});if(a&&a.length){var r=a[0];e.saveDevice(r),e.getOrder()}else e.registerDevice({user:e.altUser,deviceId:t})}else e.registerDevice({user:e.altUser,deviceId:t})},function(e){})},registerDevice:function(e){var t=this;this.actRegisterDevice(e).then(function(e){e&&(t.saveDevice(e),t.getOrder())},function(e){e&&(localStorage.removeItem("altDeviceId"),localStorage.setItem("altDeviceId",t.generateRandomId(32)),t.setUser(t.altUser),t.setAccount(t.altAccount),t.toggleLoader(!1),t.toggleClearDevicealert(!0))})},getOrder:function(){var e=this;this.actGetOrders(this.altUser).then(function(t){t.count&&t.orders?e.processOrders(t.orders[0]):(e.toggleLoader(!1),localStorage.removeItem("altUser"),localStorage.setItem("altProfileMode","default"),e.$router.push({name:"home"}))},function(e){})},processOrders:function(e){var t=(this.domain.toLowerCase(),e.price),s=e.product,i=e.dates,a={accountId:e.account?e.account:"",orderId:e.id?e.id:"",inProcessing:e.in_processing,isTrial:e.is_trial,paymentType:e.payment_type?e.payment_type:"",amount:t.amount?t.amount:"",currency:t.currency?t.currency:"",domain:t.domain?t.domain:"",realAmount:t.real_amount?t.real_amount:"",productId:s.id,recurring:s.recurring,productType:s.type,productTitle:s.titles.default,hasOrder:!0},r=((new Date).getTime()-new Date(i.valid_to.split("+")[0]).getTime())/864e5;a.expired=r>0,localStorage.setItem("altOrder",JSON.stringify(a)),this.toggleLoader(!1),localStorage.setItem("altProfileMode","default"),this.$router.push({name:"home"})},saveDevice:function(e){var t={uuid:e.uuid,appVersion:e.app_version,deviceId:e.id,ipAddress:e.ip_address,name:e.name,type:e.type,userAgent:e.user_agent};localStorage.setItem("altUser",JSON.stringify(this.altUser)),localStorage.setItem("altAccount",JSON.stringify(this.altAccount)),localStorage.setItem("altDevice",JSON.stringify(t))},searchKidsContents:function(e){var t=this;if(e.target.value.length>2){var s=e.target.value;this.actSearchQuery(s).then(function(e){if(e&&e.count){var s=new Array;for(var i in e.media)s.push(t.parseContents(e.media[i]));t.setSearchResults(s)}else t.setSearchResults(void 0)},function(e){})}else this.setSearchResults(void 0)},closeKidsSearch:function(){var e=document.getElementById("alt-kids-search-input");e.value.length?e.value="":this.toggleKidsSearch(!1)},playKidsSearchItem:function(e){this.setKidsPlayerContent(this.searchResults[e]);var t={name:"kidsPlayer",query:{type:this.searchResults[e].contentType}};"trailer"==this.searchResults[e].contentType?t.query.seriesid=this.searchResults[e].contentId:"series"==this.searchResults[e].contentType||"standup"==this.searchResults[e].contentType?t.query.seriesid=this.searchResults[e].seriesId:"movie"==this.searchResults[e].contentType&&(t.query.contentid=this.searchResults[e].contentId),this.$router.push(t)},routeToKidsModeCB:function(){var e=document.getElementById("kids-signin");e&&(e.style.display="none"),this.$router.push({name:"login"})},routeToSubscribeCB:function(){var e=document.getElementById("kids-subscribe-popup");e&&(e.style.display="none"),this.$router.push({name:"subscribe"})}}),mixins:[i.a]}},80:function(e,t,s){e.exports=s.p+"close.svg"},82:function(e,t,s){var i=s(77)(s(628),s(949),null,null,null);e.exports=i.exports},949:function(e,t,s){e.exports={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"alt-modals"},[i("div",{staticClass:"alt-popup dark-bg",staticStyle:{display:"none"},attrs:{id:"alt-popup"}},[i("div",{staticClass:"alt-popup-box"},[i("p",{attrs:{id:"alt-message"}}),e._v(" "),i("button",{staticClass:"submit-btn grad-btn btn alt-err-btn",attrs:{type:"button"},on:{click:function(t){e.toggleAltPopup(!1)}}},[e._v("ok")])])]),e._v(" "),i("div",{staticClass:"kids-signin",staticStyle:{display:"none"},attrs:{id:"kids-signin"}},[i("div",{staticClass:"kids-signin-box"},[e.altMessages?i("p",[e._v(e._s(e.altMessages.kidsModeAnonymousUser))]):e._e(),e._v(" "),e.altMessages?i("button",{staticClass:"btn grad-btn btn-sm",attrs:{type:"button"},on:{click:e.routeToKidsModeCB}},[e._v(e._s(e.altMessages.buttonKidsSignInRegister))]):e._e(),e._v(" "),e.altMessages?i("p",{staticClass:"link-under",on:{click:function(t){e.toggleKidsSigninPopup(!1)}}},[e._v(e._s(e.altMessages.buttonSkipNowMultiple))]):e._e()]),e._v(" "),i("div",{staticClass:"alt-overlay"})]),e._v(" "),i("div",{staticClass:"kids-signin",staticStyle:{display:"none"},attrs:{id:"kids-subscribe-popup"}},[i("div",{staticClass:"kids-signin-box"},[e.altMessages?i("p",{staticClass:"text-block-top"},[e._v(e._s(e.altMessages.kidsModeFreeUser))]):e._e(),e._v(" "),e.altMessages?i("button",{staticClass:"btn grad-btn btn-lg",attrs:{type:"button"},on:{click:e.routeToSubscribeCB}},[e._v(e._s(e.altMessages.buttonSubscribeNowMultiple))]):e._e(),e._v(" "),e.altMessages?i("p",{staticClass:"link-under text-block-bottom",on:{click:function(t){e.toggleKidsSubscribePopup(!1)}}},[e._v(e._s(e.altMessages.buttonSkipNowMultiple))]):e._e()]),e._v(" "),i("div",{staticClass:"alt-overlay"})]),e._v(" "),i("div",{staticClass:"kids-signin",staticStyle:{display:"none"},attrs:{id:"subscribe-popup"}},[i("div",{staticClass:"kids-signin-box"},[i("p",{staticClass:"text-block-top"},[e._v("You don't want your kids to see all the shows! Sign in to enable parental lock.")]),e._v(" "),i("button",{staticClass:"btn grad-btn btn-sm",attrs:{type:"button"},on:{click:function(t){e.$router.push({name:"subscribe"})}}},[e._v("Subscribe Now")]),e._v(" "),e.altMessages?i("p",{staticClass:"link-under text-block-bottom",on:{click:function(t){e.toggleSubscribePopup(!1)}}},[e._v(e._s(e.altMessages.buttonSkipNowMultiple))]):e._e()]),e._v(" "),i("div",{staticClass:"alt-overlay"})]),e._v(" "),i("div",{staticClass:"pin-screen",staticStyle:{display:"none"},attrs:{id:"pin-first-screen"}},[i("div",{staticClass:"pin-screen-box"},[e.firstPinActive?i("div",{staticClass:"confirm-pin"},[i("p",[e._v("Confirm PIN")]),e._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:e.confirmPin,expression:"confirmPin"}],staticClass:"pin-control",attrs:{type:"tel",size:"4",maxlength:"4",placeholder:"...."},domProps:{value:e.confirmPin},on:{keyup:function(t){e.validateConfirmPin(t)},input:function(t){t.target.composing||(e.confirmPin=t.target.value)}}})]):i("div",{staticClass:"first-pin"},[i("p",[e._v("This is your first time. Set PIN to access kids mode")]),e._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:e.pin,expression:"pin"}],staticClass:"pin-control",attrs:{type:"tel",size:"4",maxlength:"4",placeholder:"...."},domProps:{value:e.pin},on:{keyup:function(t){e.validateFirstPin(t)},input:function(t){t.target.composing||(e.pin=t.target.value)}}}),e._v(" "),i("p",{directives:[{name:"show",rawName:"v-show",value:e.pinError,expression:"pinError"}],staticClass:"pin-error"},[e._v(e._s(e.pinErrorMessage))])])]),e._v(" "),i("img",{staticClass:"kids-pin-close",attrs:{src:s(80),alt:"close"},on:{click:function(t){e.toggleFirstPinScreen(!1)}}}),e._v(" "),i("div",{staticClass:"alt-dark-overlay"})]),e._v(" "),i("div",{staticClass:"exit-pin-screen alt-popup-bg dark-bg",staticStyle:{display:"none"},attrs:{id:"exit-pin-screen"}},[i("div",{staticClass:"pin-screen-header"},[i("img",{staticClass:"kids-pin-close",attrs:{src:s(80),alt:"close"},on:{click:e.closeExitKidsPinScreen}}),e._v(" "),i("div",{staticClass:"clearfix"})]),e._v(" "),i("div",{staticClass:"pin-screen-box"},[i("p",[e._v("Please enter 4 digit passcode below to exit")]),e._v(" "),i("p",[e._v("To reset your password please visit 'My Account' by clicking top right icon on the website")]),e._v(" "),i("div",{staticClass:"pin-control-box"},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.exitKidsScreenCode,expression:"exitKidsScreenCode"}],staticClass:"pin-control",attrs:{type:"tel",size:"4",maxlength:"4",placeholder:"...."},domProps:{value:e.exitKidsScreenCode},on:{keyup:function(t){e.exitKidsEvent(t)},input:function(t){t.target.composing||(e.exitKidsScreenCode=t.target.value)}}})]),e._v(" "),e.altMessages?i("p",{directives:[{name:"show",rawName:"v-show",value:e.pinError,expression:"pinError"}],staticClass:"pin-error"},[e._v(e._s(e.altMessages.kidsModeIncorrectPin))]):e._e()])])])},staticRenderFns:[]}}});