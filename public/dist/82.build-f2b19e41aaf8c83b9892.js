webpackJsonp([82],{641:function(e,t,i){"use strict";function s(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}Object.defineProperty(t,"__esModule",{value:!0});var n,o=i(1),r=i(5),a=i(4),l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e};t.default={data:function(){return{exitPin:"",pinError:!1,altUser:!1}},computed:l({},i.i(a.a)(["passphrase","altMessages"])),methods:l({},i.i(a.b)([]),i.i(a.c)(["actEditAccount","actCreateNewProfile","actCheckWithAccount","actGetProfileSwitch","actGetProfileSwitch"]),(n={validateExitPin:function(e){4==e.target.value.length&&(this.toggleLoader(!0),this.pinError=!1,this.checkUserAccount())},checkUserAccount:function(){var e=this;this.actCheckWithAccount().then(function(t){if(t.count){var i=t.profiles[0];i.pin=e.exitPin,e.switchToDefaultProfile(i)}else e.$router.push({name:"createKidsPin"})},function(t){t.code&&404==t.code?o.eventBus.$emit("togglePopupDeviceRemoved",!1):(e.clearUserData(),o.eventBus.$emit("toggleAppModeChangeEvent","default"),window.location.reload())})},switchToDefaultProfile:function(e){var t=this;this.actGetProfileSwitch(e).then(function(e){var i=void 0;localStorage.getItem("altUser")&&(i=JSON.parse(localStorage.getItem("altUser"))),i&&(i.sessionToken=e.session_token,i.uuid=e.uuid,i.username=e.username,localStorage.setItem("altUser",JSON.stringify(i))),o.eventBus.$emit("toggleAppModeChangeEvent","default"),t.closePopup(),t.$router.push({name:"home"})}).catch(function(e){401==e.code&&(t.pinError=e.message?"Incorrect PIN":"Wrong Pin",t.toggleLoader(!1))})},switchProfile:function(){var e=this;this.actGetProfileSwitch(this.altKidsUser).then(function(t){t&&(e.altKidsUser.sessionToken=t.session_token,e.altKidsUser.uuid=t.uuid,e.altKidsUser.parentalControl=t.parental_control,localStorage.setItem("altProfileMode","kids"),localStorage.setItem("altKidsUser",JSON.stringify(e.altKidsUser)),e.$router.push({name:"kidsMode"}))},function(e){})},validateConfimPin:function(e){var t=this;if(e.target.value.length>3)if(this.firstPin==this.confirmPin){var i=JSON.parse(localStorage.getItem("altUser"));this.actEditAccount({marketingConsent:!1,pin:this.firstPin,details:{},Account_Id:i.accountId,Profile_Id:i.profileId}).then(function(e){e.status&&"ok"==e.status&&t.createKidsProfile()},function(e){})}else this.pinError="Incorrect PIN"},createKidsProfile:function(){var e=this,t=JSON.parse(localStorage.getItem("altUser")),i={parental_control:"R",password:t.login,type:"regular",username:"kids"+t.login};this.actCreateNewProfile(i).then(function(t){e.switchProfile(i)},function(e){})}},s(n,"switchProfile",function(e){var t=this,i=JSON.parse(localStorage.getItem("altUser")),s={pin:this.firstPin,profileId:i.profileId};this.actGetProfileSwitch(s).then(function(i){e.email=i.email,e.parentalControl=i.parental_control,e.sessionToken=i.session_token,e.username=i.username,e.uuid=i.uuid,localStorage.setItem("altKidsUser",JSON.stringify(e)),localStorage.setItem("altProfileMode","kids"),t.$router.push({name:"home"})},function(e){})}),s(n,"closePopup",function(){this.exitPin="",this.pinError=!1,o.eventBus.$emit("togglePopupKidsExitPin",!1)}),n)),created:function(){localStorage.getItem("altUser")&&(this.altUser=JSON.parse(localStorage.getItem("altUser")))},mounted:function(){},mixins:[r.a]}},80:function(e,t,i){e.exports=i.p+"close.svg"},900:function(e,t,i){var s=i(77)(i(641),i(993),null,null,null);e.exports=s.exports},993:function(e,t,i){e.exports={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"kids-exit-pin-screen alt-popup-bg dark-bg",attrs:{id:"kids-exit-pin-screen"}},[s("div",{staticClass:"pin-screen-header"},[s("img",{staticClass:"kids-pin-close",attrs:{src:i(80),alt:"close"},on:{click:e.closePopup}})]),e._v(" "),s("div",{staticClass:"pin-screen-box"},[e.altMessages?s("p",{staticStyle:{"white-space":"pre-wrap"}},[e._v(e._s(e.altMessages.kidsModeExitMessage))]):e._e(),e._v(" "),s("div",{staticClass:"pin-control-box"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.exitPin,expression:"exitPin"}],staticClass:"pin-control",attrs:{type:"tel",size:"4",maxlength:"4",placeholder:"....",id:"alt-kids-exit-pin-elm",autofocus:""},domProps:{value:e.exitPin},on:{keyup:e.validateExitPin,input:function(t){t.target.composing||(e.exitPin=t.target.value)}}})]),e._v(" "),s("p",{directives:[{name:"show",rawName:"v-show",value:e.pinError,expression:"pinError"}],staticClass:"pin-error"},[e._v(e._s(e.pinError))])])])},staticRenderFns:[]}}});