webpackJsonp([53],{1038:function(e,t,o){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.isCampaignPage?a("div",[a("div",[a("p",{staticStyle:{"font-size":"12px"}},[e._v("Or SignIn with your social account")]),e._v(" "),a("img",{staticClass:"fb-logo",staticStyle:{width:"34px",height:"30px"},attrs:{src:o(716),alt:"fb-logo"},on:{click:function(t){e.loginWithFacebook()}}})])]):a("div",[a("div",{staticClass:"text-center"},[a("router-link",{staticClass:"forgot-psw link-under",attrs:{to:{name:"resetPassword"}}},[e._v("Forgot your Password?")])],1),e._v(" "),a("button",{staticClass:"fb-btn",attrs:{type:"button"},on:{click:function(t){e.loginWithFacebook()}}},[a("img",{staticClass:"fb-logo",attrs:{src:o(120),alt:"fb-logo"}}),e._v(" "),e.altMessages?a("span",{staticClass:"fb-txt"},[e._v(e._s(e.altMessages.buttonSignInFacebook))]):e._e()]),e._v(" "),a("p",{staticClass:"text-center"},[e._v("By signing in, you agree to the "),a("router-link",{staticClass:"link-under",attrs:{to:{name:"toc"}}},[e._v("Terms of Use")]),e._v(" and "),a("router-link",{staticClass:"link-under",attrs:{to:{name:"privacyPolicy"}}},[e._v("Privacy Policy")]),e._v(".")],1),e._v(" "),a("div",{staticClass:"access-ac"},[e._v("Don't have an account yet? Sign up now.")]),e._v(" "),a("router-link",{staticClass:"signup-btn",attrs:{tag:"button",to:"/signup",type:"button"}},[e._v("Sign Up")])],1)])},staticRenderFns:[]}},120:function(e,t,o){e.exports=o.p+"fb.svg"},186:function(e,t,o){var a=o(77)(o(585),o(1038),null,null,null);e.exports=a.exports},585:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o(5),r=o(4),i=o(1),n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&(e[a]=o[a])}return e};t.default={data:function(){return{userData:void 0,fbAccessToken:void 0,altUser:void 0,altAccount:void 0,fbAuthMode:"login",counter:1}},computed:n({},o.i(r.a)(["altMessages","routerFromParam","routerToParam"])),props:["isCampaignPage"],methods:n({},o.i(r.b)(["setUser","setAccount","setRouterToParam","setRouterFromParam","setDeleteError","setUser","setAccount"]),o.i(r.c)(["actAccountLookup","actFacebookLogin","actGetAccountDetails","actGetDeviceList","actRegisterDevice","actGetOrders"]),{loginWithFacebook:function(){var e=this,t=this;this.toggleLoader(!0),FB.login(function(o){if(o.authResponse){e.fbAccessToken=o.authResponse.accessToken;var a=o.authResponse.userID;FB.api("/"+a,{fields:"name, email, age_range"},function(o){return o.error&&190==o.error.code?void t.loginWithFacebook():o.email?o.age_range&&o.age_range.min<18?(i.eventBus.$emit("togglePopupFbBelowAge",!0),void e.toggleLoader(!1)):void(o.email&&(e.userData={login:o.email},e.accountLookUp())):(i.eventBus.$emit("togglePopupFbLoginError",!0),void e.toggleLoader(!1))})}else e.toggleLoader(!1)},{scope:"email, public_profile",return_scopes:!0})},accountLookUp:function(){var e=this;this.toggleLoader(!0),this.actAccountLookup(this.userData).then(function(t){t.status&&"ok"==t.status&&e.facebookLoginCb()},function(t){404==t.code&&e.handleErrorAccount(t)})},handleErrorAccount:function(e){if(404==e.code&&"Account not found"==e.message){if(2==this.counter)return localStorage.setItem("homeDomain",localStorage.getItem("visitedDomain")),this.counter=1,this.fbAuthMode="signup",void this.facebookLoginCb();var t=localStorage.getItem("homeDomain");t="IN"==t?"row":"IN",localStorage.setItem("homeDomain",t),this.counter=2,this.accountLookUp()}},facebookLoginCb:function(){var e=this;console.log("fbAuthMode",this.fbAuthMode),this.actFacebookLogin({access_token:this.fbAccessToken}).then(function(t){var o=t.account,a=t.account.profile,r={sessionToken:t.session_token?t.session_token:"",dateCreated:o.date_created?o.date_created:"",email:o.email?o.email:"",accountId:o.id?o.id:"",isAdmin:o.is_admin?o.is_admin:"",login:o.login?o.login:"",username:a.username?a.username:"",profileId:a.id?a.id:""};localStorage.setItem("token",t.session_token),localStorage.setItem("user_email",t.account.email),localStorage.setItem("account_id",t.account.id),e.altUser=r,e.getAccountLookup()},function(t){i.eventBus.$emit("togglePopupFbLoginError",!0),e.toggleLoader(!1)})},getAccountLookup:function(){var e=this;this.toggleLoader(!0),this.actGetAccountDetails(this.altUser).then(function(t){if(e.altAccount={dateCreated:e.formatIsoDate(t.date_created),details:t.details,emailVerified:t.email_verified,marketingConcent:t.marketing_consent,phoneNumber:t.phone_number,profile:t.profile},localStorage.setItem("altUser",JSON.stringify(e.altUser)),localStorage.setItem("altAccount",JSON.stringify(e.altAccount)),e.webenageSetup(),"signup"==e.fbAuthMode&&window.mobileAnalyticsClient){var o=e.getAWSMACommonAttributes();o.event_mode="facebook",window.mobileAnalyticsClient.recordEvent("_user.signup",o,{})}if(localStorage.setItem("user_name",t.name+" "+t.surname),localStorage.setItem("user_birthday",t.details.birthday?t.details.birthday:""),localStorage.setItem("user_gender",t.details.gender?t.details.gender:""),localStorage.setItem("user_email",e.altUser.email),window.mobileAnalyticsClient){var o=e.getAWSMACommonAttributes();o.event_mode="facebook",window.mobileAnalyticsClient.recordEvent("_user.login",o,{})}localStorage.removeItem("altUser"),localStorage.removeItem("altAccount"),e.getDevice()},function(e){})},webenageSetup:function(){var e=localStorage.getItem("altUser")?JSON.parse(localStorage.getItem("altUser")).accountId:void 0;e&&webengage&&(webengage.user.login(e),this.webengageLoginAttribute(e))},webengageLoginAttribute:function(e){var t=JSON.parse(localStorage.getItem("altAccount")),o=(JSON.parse(localStorage.getItem("altUser")),{we_first_name:t&&t.name&&"null"!=t.name?t.name:"N.A",we_hashed_email:e||"N.A",we_gender:t.details.gender?t.details.gender.toLowerCase():"male",we_hashed_phone:e||"N.A",we_birth_date:t.details.birthday?t.details.birthday:"1986-08-19",we_email_opt_in:!0,we_sms_opt_in:!0});webengage.user.setAttribute(o),this.webenageLoginSignupFire()},webenageLoginSignupFire:function(){var e=this.altDetectPlatform(),t=void 0;localStorage.getItem("altGeoData")&&(t=JSON.parse(localStorage.getItem("altGeoData")));var o={gt_platform:e&&e.os&&e.osVersion?e.os+" "+e.osVersion:" ",gt_device_make:e&&e.device_model?e.device_model:" ",gt_country:t&&t.country&&t.country.names&&t.country.names.en?t.country.names.en:"",gt_city:t&&t.city&&t.city.names&&t.city.names.en?String(t.city.names.en):"",gt_device_timestamp:new Date};webengage&&("signup"==this.fbAuthMode?(webengage.track("gt_complete_registration",o),console.log("gt_complete_registration",o)):(webengage.track("gt_login",o),console.log("gt_login",o)))},getDevice:function(){var e=this,t=localStorage.getItem("altDeviceId");this.setUser(this.altUser),this.setAccount(this.altAccount),t||(t=this.generateRandomId(32)),this.actGetDeviceList(this.altUser).then(function(o){if(o.count){var a=o.devices,r=a.filter(function(e){return e.uuid==t});if(r&&r.length){var i=r[0];e.saveDevice(i),e.getOrder()}else e.registerDevice({user:e.altUser,deviceId:t})}else e.registerDevice({user:e.altUser,deviceId:t})},function(e){})},registerDevice:function(e){var t=this;this.actRegisterDevice(e).then(function(e){e&&(t.saveDevice(e),t.getOrder())},function(e){if(409==e.code){localStorage.removeItem("altDeviceId");var o=t.generateRandomId(32);return localStorage.setItem("altDeviceId",o),void t.registerDevice({user:t.altUser,deviceId:o})}400==e.code?(localStorage.removeItem("altUser"),t.toggleLoader(!1),t.deleteError>4?(localStorage.setItem("fb",!0),i.eventBus.$emit("closeClearDevicesEvent")):(t.setDeleteError(0),localStorage.setItem("fb",!0),i.eventBus.$emit("showClearDevicesEvent"))):t.loginWithFacebook()})},getOrder:function(){var e=this;this.actGetOrders(this.altUser).then(function(t){if(t.count&&t.orders)e.processOrders(t.orders);else{localStorage.setItem("altOrder",JSON.stringify({tvod:{hasOrder:!1},subscription:{hasOrder:!1,expired:!1}})),e.toggleLoader(!1);if(localStorage.getItem("campaign-redirect")?localStorage.getItem("campaign-redirect"):void 0)return localStorage.removeItem("campaign-redirect"),void window.location.replace(location.protocol+"//"+location.host+"/paymentOptions");if(localStorage.getItem("promotional-redirect")?localStorage.getItem("promotional-redirect"):void 0)return localStorage.removeItem("promotional-redirect"),void window.location.replace(location.protocol+"//"+location.host+"/promotion/paymentStatus");var o=localStorage.getItem("homeDomain");if("IN"==o||"in"==o){if("signup"==e.fbAuthMode&&e.altAccount.details&&!e.altAccount.details.state)return void i.eventBus.$emit("togglePopupFBStateSelectEvent",!0);if(e.altAccount.details&&!e.altAccount.details.state)return void i.eventBus.$emit("togglePopupStateSelectEvent",!0)}e.redirection()}},function(e){})},processOrders:function(e){var t=new Object,o=e.filter(function(e){return 0==e.product.recurring}),a=[];if(o&&o.length){var r=!1;t.tvod={};for(var n in o){var s=((new Date).getTime()-new Date(o[n].dates.valid_to.split("+")[0]).getTime())/864e5;s<0&&(r=!0,n,o[n].expired=!1,a.push(o[n]))}t.tvod=r?{hasOrder:!0,products:a}:{hasOrder:!1}}else t.tvod={hasOrder:!1};var c=e.filter(function(e){return 1==e.product.recurring});if(c&&c.length){var l=!1,u=0;t.subscription={},t.subscription.hasOrder=!1,t.subscription.expired=!0;for(var n in c){var s=((new Date).getTime()-new Date(c[n].dates.valid_to.split("+")[0]).getTime())/864e5;if(s<0){l=!0,u=n;break}}if(l){t.subscription=c[u],t.subscription.hasOrder=!0,t.subscription.expired=!1,localStorage.setItem("altOrder",JSON.stringify(t));if(localStorage.getItem("campaign-redirect")?localStorage.getItem("campaign-redirect"):void 0)return localStorage.removeItem("campaign-redirect"),void window.location.replace(location.protocol+"//"+location.host);var g=localStorage.getItem("promotional-redirect")?localStorage.getItem("promotional-redirect"):void 0;if(g)return localStorage.removeItem("promotional-redirect"),void window.location.replace(location.protocol+"//"+location.host+"/promotion/paymentStatus");var d=localStorage.getItem("homeDomain");if("IN"==d||"in"==d){if("signup"==this.fbAuthMode&&this.altAccount.details&&!this.altAccount.details.state)return void i.eventBus.$emit("togglePopupFBStateSelectEvent",!0);if(this.altAccount.details&&!this.altAccount.details.state)return void i.eventBus.$emit("togglePopupStateSelectEvent",!0)}this.redirection(),this.setRouterToParam(void 0),this.setRouterFromParam(void 0)}else{if(localStorage.getItem("campaign-redirect")?localStorage.getItem("campaign-redirect"):void 0)return localStorage.removeItem("campaign-redirect"),void window.location.replace(location.protocol+"//"+location.host+"/paymentOptions");var g=localStorage.getItem("promotional-redirect")?localStorage.getItem("promotional-redirect"):void 0;if(g)return localStorage.removeItem("promotional-redirect"),void window.location.replace(location.protocol+"//"+location.host+"/promotion/paymentStatus");if(this.routerFromParam&&"player"==this.routerFromParam.name)return void this.addToFavourite();var d=localStorage.getItem("homeDomain");if("IN"==d||"in"==d){if("signup"==this.fbAuthMode&&this.altAccount.details&&!this.altAccount.details.state)return void i.eventBus.$emit("togglePopupFBStateSelectEvent",!0);if(this.altAccount.details&&!this.altAccount.details.state)return void i.eventBus.$emit("togglePopupStateSelectEvent",!0)}this.redirection(),this.setRouterToParam(void 0),this.setRouterFromParam(void 0),localStorage.setItem("altOrder",JSON.stringify(t))}}else{t.subscription={hasOrder:!1,expired:!0},localStorage.setItem("altOrder",JSON.stringify(t)),this.toggleLoader(!1);if(localStorage.getItem("campaign-redirect")?localStorage.getItem("campaign-redirect"):void 0)return localStorage.removeItem("campaign-redirect"),void window.location.replace(location.protocol+"//"+location.host+"/paymentOptions");var g=localStorage.getItem("promotional-redirect")?localStorage.getItem("promotional-redirect"):void 0;if(g)return localStorage.removeItem("promotional-redirect"),void window.location.replace(location.protocol+"//"+location.host+"/promotion/paymentStatus");var d=localStorage.getItem("homeDomain");if("IN"==d||"in"==d){if("signup"==this.fbAuthMode&&this.altAccount.details&&!this.altAccount.details.state)return void i.eventBus.$emit("togglePopupFBStateSelectEvent",!0);if(this.altAccount.details&&!this.altAccount.details.state)return void i.eventBus.$emit("togglePopupStateSelectEvent",!0)}this.redirection()}},redirection:function(){var e=void 0;if(localStorage.getItem("altOrder")&&(e=JSON.parse(localStorage.getItem("altOrder"))),this.routerFromParam)if("media"==this.routerFromParam.name||"show"==this.routerFromParam.name||"episode"==this.routerFromParam.name)this.routerFromParam.extra&&"player-favourite"==this.routerFromParam.extra.name?(this.addToFavourite(),this.$router.push(this.routerFromParam.fullPath)):this.$router.push(this.routerFromParam.fullPath);else if("kids"==this.routerFromParam.name)e&&e.subscription&&e.subscription.hasOrder&&0==e.subscription.expired?this.postLoginSwitchToKids():this.$router.push({name:"subscribe"});else if("rent"==this.routerFromParam.name)if(e&&e.subscription&&e.subscription.hasOrder&&0==e.subscription.expired)this.$router.push({path:this.routerFromParam.fullPath});else if(e&&e.tvod&&e.tvod.hasOrder){homeDomain=homeDomain.toLowerCase();var t=void 0;for(t in e.tvod.products)if(e.tvod.products[t].product.id==this.routerFromParam.params.tvod[homeDomain])return void this.$router.push({path:this.routerFromParam.fullPath});this.$router.push("/rent/show/"+this.routerFromParam.params.id)}else this.$router.push("/rent/show/"+this.routerFromParam.params.id);else"subscribe"==this.routerFromParam.name?this.postLoginSubscribeCB():this.$router.push({name:"home"});else this.$router.push({name:"home"})},saveDevice:function(e){var t={uuid:e.uuid,appVersion:e.app_version,deviceId:e.id,ipAddress:e.ip_address,name:e.name,type:e.type,userAgent:e.user_agent};localStorage.setItem("altUser",JSON.stringify(this.altUser)),localStorage.setItem("altAccount",JSON.stringify(this.altAccount)),localStorage.setItem("altDevice",JSON.stringify(t))}}),created:function(){var e=this;console.log("LoginMisc.vue || isCampaignPage",this.isCampaignPage),console.log("LoginMisc.vue || created"),i.eventBus.$on("fbDeviceDelete",function(){localStorage.setItem("altUser",JSON.stringify(e.altUser)),localStorage.setItem("altAccount",JSON.stringify(e.altAccount));var t=void 0;localStorage.getItem("altUser")&&(JSON.parse(localStorage.getItem("altUser")),localStorage.getItem("altOrder")&&(t=JSON.parse(localStorage.getItem("altOrder"))),t&&t.subscription&&t.subscription.hasOrder&&0==t.subscription.expired?i.eventBus.$emit("changeHeaderSubcribeButton",!1):i.eventBus.$emit("changeHeaderSubcribeButton",!0)),e.getDevice()})},mixins:[a.a]}},716:function(e,t,o){e.exports=o.p+"facebook-one.png"}});